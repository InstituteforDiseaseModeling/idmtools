

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Parameter sweeps and model iteration &mdash; IDM-Tools  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/tipuesearch/tipuesearch.js"></script>
        <script src="_static/tipuesearch/tipuesearch_content.js"></script>
        <script src="_static/tipuesearch/tipuesearch_set.js"></script>
        <script src="_static/runsearch.js"></script>
        <script src="_static/tablecollapse.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within IDM-Tools  documentation"
          href="_static/opensearch.xml"/>

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="_static/tipuesearch/tipuesearch.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Running parameter sweeps with R models" href="sweeps-r.html" />
    <link rel="prev" title="Create EMOD simulations" href="create-sims-emod.html" />

<link href="https://fonts.googleapis.com/css?family=Lato|Montserrat|Open+Sans" rel="stylesheet">


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> IDM-Tools
          

          
            
            <img src="_static/IDM_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.2.1
              </div>
            
          

          <div role="search">
    <form action="search-local.html" class='wy-form' id='rtd-search-form' method="get">
        <input autocomplete="off" id="tipue_search_input" name="q" placeholder="Search docs"
               required type="text">
    </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="create-sims.html">Create and run simulations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Parameter sweeps and model iteration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sweeps-r.html">Running parameter sweeps with R models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sweeps-python.html">Running parameter sweeps with Python models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sweeps-emod.html">Running parameter sweeps with EMOD</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="calibrate.html">Calibrate simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzers.html">Introduction to analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="reports.html">Output reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="plots.html">Plot data</a></li>
<li class="toctree-l1"><a class="reference internal" href="serialization.html">Serialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookiecutters.html">Cookiecutter example projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Architecture and packages reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli_index.html">CLI reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">IDM-Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          





<div aria-label="breadcrumbs navigation" role="navigation">
    <ul class="wy-breadcrumbs">
        <li><a href="https://idmod.org/documentation">IDM docs</a> &raquo;</li>
        <li><a href="index.html">IDM-Tools</a> &raquo;</li>
        
        <li>Parameter sweeps and model iteration</li>
        <li class="wy-breadcrumbs-aside">
            
            
            
        </li>
    </ul>
    <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- From _templates/page.html -->

  <div class="section" id="parameter-sweeps-and-model-iteration">
<h1>Parameter sweeps and model iteration<a class="headerlink" href="#parameter-sweeps-and-model-iteration" title="Permalink to this headline">¶</a></h1>
<p>In modeling, parameter sweeps are an important method for fine-tuning parameter values, exploring
parameter space, and calibrating simulations to data. A parameter sweep is an iterative process
in which simulations are run repeatedly using different values of the parameter(s) of choice. This
process enables the modeler to determine a parameter’s “best” value (or range of values), or
even where in parameter space the model produces desirable (or non-desirable) behaviors.</p>
<p>When fitting models to data, it is likely that there will be numerous parameters that do not have a
pre-determined value.  Some parameters will have a range of values that are biologically plausible,
or have been determined from previous experiments; however, selecting a particular numerical value
to use in the model may not be feasible or realistic. Therefore, the best practice involves using a
parameter sweep to narrow down the  range of possible values or to provide a range of outcomes for
those possible values.</p>
<p>IDM-Tools provides an automated approach to parameter sweeps. With few lines of code, it is possible to
test the model over any range of parameter values, with any combination of parameters. Note that
parameter sweeps are a simple method of model calibration, and there are more complex calibration
algorithms available of IDM-Tools.  See <a class="reference internal" href="calibrate.html"><span class="doc">Calibrate simulations</span></a> for more information on additional methods.</p>
<div class="contents local topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#parameter-sweeps-for-model-calibration" id="id1">Parameter sweeps for model calibration</a></p></li>
<li><p><a class="reference internal" href="#parameter-sweeps-and-stochasticity" id="id2">Parameter sweeps and stochasticity</a></p></li>
<li><p><a class="reference internal" href="#how-to-do-parameter-sweeps" id="id3">How to do parameter sweeps</a></p>
<ul>
<li><p><a class="reference internal" href="#using-builders" id="id4">Using builders</a></p></li>
<li><p><a class="reference internal" href="#creating-sweeps-without-builders" id="id5">Creating sweeps without builders</a></p></li>
<li><p><a class="reference internal" href="#running-parameter-sweeps-in-specific-models" id="id6">Running parameter sweeps in specific models</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="parameter-sweeps-for-model-calibration">
<h2><a class="toc-backref" href="#id1">Parameter sweeps for model calibration</a><a class="headerlink" href="#parameter-sweeps-for-model-calibration" title="Permalink to this headline">¶</a></h2>
<p>For more information on model calibration, see <a class="reference internal" href="calibrate.html"><span class="doc">Calibrate simulations</span></a>.</p>
</div>
<div class="section" id="parameter-sweeps-and-stochasticity">
<h2><a class="toc-backref" href="#id2">Parameter sweeps and stochasticity</a><a class="headerlink" href="#parameter-sweeps-and-stochasticity" title="Permalink to this headline">¶</a></h2>
<p>With a stochastic model (such as EMOD), it is especially important to utilize parameter sweeps,
not only for calibration to data or parameter selection, but to fully explore the stochasticity in
output. Single model runs may appear to provide good fits to data, but variation will arise and
multiple runs are necessary to determine the appropriate range of parameter values necessary to
achieve  desired outcomes. Multiple iterations of a single set of parameter values should be run to
determine trends in simulation output: a single simulation output could provide results that are due
to random chance.</p>
</div>
<div class="section" id="how-to-do-parameter-sweeps">
<h2><a class="toc-backref" href="#id3">How to do parameter sweeps</a><a class="headerlink" href="#how-to-do-parameter-sweeps" title="Permalink to this headline">¶</a></h2>
<p>With idmtools, you can do parameter sweeps with builders or without builders using a base task to set
your simulation parameters.</p>
<p>The typical ‘output’ of IDM-Tools is a config.json file for each created simulation, which contains
the parameter values assigned: both the constant values and those being swept.</p>
<div class="section" id="using-builders">
<h3><a class="toc-backref" href="#id4">Using builders</a><a class="headerlink" href="#using-builders" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>In this release, to support parameter sweeps for models, we have the following builders to assist you:</dt><dd><ol class="arabic simple">
<li><p>SimulationBuilder - you set your sweep parameters in your scripts and it generates a config.json file with your sweeps for your experiment/simulations to use</p></li>
<li><p>CSVExperimentBuilder - you can use a CSV file to do your parameter sweeps</p></li>
<li><p>YamlSimulationBuilder - you can use a Yaml file to do your parameter sweeps</p></li>
<li><p>Arm Builder for cross and pair parameters, which allows you to cross parameters, like you cross your arms.</p></li>
</ol>
</dd>
</dl>
<p>There are two types of sweeping, cross and pair. Cross means you have for example, 3 x 3 = 9 set of parameters, and pair means 3 + 3 = 3 pairs of parameters, for example, a, b, c and d, e, f.</p>
<p>For cross sweeping, let’s say again you have parameters a, b, c and d, e, f that you want to cross so you would have the following possible matches:
- a &amp; d
- a &amp; e
- a &amp; f
- b &amp; d
- b &amp; e
- b &amp; f
- c &amp; d
- c &amp; e
- c &amp; f</p>
<p>For Python models, we also support them using a JSONConfiguredPythonTask. In the future we will support additional configured tasks for Python and R models.</p>
</div>
<div class="section" id="creating-sweeps-without-builders">
<h3><a class="toc-backref" href="#id5">Creating sweeps without builders</a><a class="headerlink" href="#creating-sweeps-without-builders" title="Permalink to this headline">¶</a></h3>
<p>You can also create sweeps without using builders. Like this example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This file demonstrates how to create param sweeps without builders.</span>

<span class="sd">        we create base task including our common assets, e.g. our python model to run</span>
<span class="sd">        we create 5 simulations and for each simulation, we set parameter &#39;a&#39; = [0,4] and &#39;b&#39; = a + 10 using this task</span>
<span class="sd">        then we are adding this to task to our Experiment to run our simulations</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">idmtools.assets</span> <span class="kn">import</span> <span class="n">AssetCollection</span>
<span class="kn">from</span> <span class="nn">idmtools.core.platform_factory</span> <span class="kn">import</span> <span class="n">Platform</span>
<span class="kn">from</span> <span class="nn">idmtools.entities.experiment</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">idmtools.entities.simulation</span> <span class="kn">import</span> <span class="n">Simulation</span>
<span class="kn">from</span> <span class="nn">idmtools_models.python.json_python_task</span> <span class="kn">import</span> <span class="n">JSONConfiguredPythonTask</span>
<span class="kn">from</span> <span class="nn">idmtools_test</span> <span class="kn">import</span> <span class="n">COMMON_INPUT_PATH</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="c1"># define our platform</span>
    <span class="n">platform</span> <span class="o">=</span> <span class="n">Platform</span><span class="p">(</span><span class="s1">&#39;COMPS2&#39;</span><span class="p">)</span>

    <span class="c1"># create experiment  object and define some extra assets</span>
    <span class="n">assets_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">COMMON_INPUT_PATH</span><span class="p">,</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span> <span class="s2">&quot;Assets&quot;</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;string_tag&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;number_tag&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">},</span>
                   <span class="n">assets</span><span class="o">=</span><span class="n">AssetCollection</span><span class="o">.</span><span class="n">from_directory</span><span class="p">(</span><span class="n">assets_path</span><span class="p">))</span>

    <span class="c1"># define paths to model and extra assets folder container more common assets</span>
    <span class="n">model_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">COMMON_INPUT_PATH</span><span class="p">,</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span> <span class="s2">&quot;model.py&quot;</span><span class="p">)</span>

    <span class="c1"># define our base task including the common assets. We could also add these assets to the experiment above</span>
    <span class="n">base_task</span> <span class="o">=</span> <span class="n">JSONConfiguredPythonTask</span><span class="p">(</span><span class="n">script_path</span><span class="o">=</span><span class="n">model_path</span><span class="p">,</span> <span class="n">envelope</span><span class="o">=</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span>
    <span class="n">base_simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="o">.</span><span class="n">from_task</span><span class="p">(</span><span class="n">base_task</span><span class="p">)</span>

    <span class="c1"># now build our simulations</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="c1"># first copy the simulation</span>
        <span class="n">sim</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_simulation</span><span class="p">)</span>
        <span class="c1"># configure it</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
        <span class="c1"># and add it to the simulations</span>
        <span class="n">e</span><span class="o">.</span><span class="n">simulations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

    <span class="c1"># run the experiment</span>
    <span class="n">e</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">platform</span><span class="o">=</span><span class="n">platform</span><span class="p">)</span>
    <span class="c1"># wait on it</span>
    <span class="c1"># in most real scenarios, you probably do not want to wait as this will wait until all simulations</span>
    <span class="c1"># associated with an experiment are done. We do it in our examples to show feature and to enable</span>
    <span class="c1"># testing of the scripts</span>
    <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="c1"># use system status as the exit code</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">succeeded</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="running-parameter-sweeps-in-specific-models">
<h3><a class="toc-backref" href="#id6">Running parameter sweeps in specific models</a><a class="headerlink" href="#running-parameter-sweeps-in-specific-models" title="Permalink to this headline">¶</a></h3>
<p>The following pages provide information about running parameter sweeps in particular models, and
include example scripts.</p>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Model-specific parameter sweep information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sweeps-r.html">Running parameter sweeps with R models</a></li>
<li class="toctree-l1"><a class="reference internal" href="sweeps-python.html">Running parameter sweeps with Python models</a></li>
<li class="toctree-l1"><a class="reference internal" href="sweeps-emod.html">Running parameter sweeps with EMOD</a></li>
</ul>
</div>
</div>
</div>
</div>


<div id="tipue_search_content"></div>

           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sweeps-r.html" class="btn btn-neutral float-right" title="Running parameter sweeps with R models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="create-sims-emod.html" class="btn btn-neutral float-left" title="Create EMOD simulations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intellectual Ventures Management, LLC (IVM). All rights reserved

    </p>
  </div>
<p>IDM-Tools is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode">Creative Commons
    Attribution-Noncommercial-ShareAlike 4.0 License</a>.</p>
<p>Send documentation feedback to <a href="mailto:feedback@idmod.org" target="_top">feedback@idmod.org</a>. If you have
    questions, email <a href="mailto:support@idmod.org" target="_top">support@idmod.org</a>.</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<!-- Google analytics for IDM docs -->
 
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-87656833-3', 'auto');
    ga('send', 'pageview');

</script>



</body>
</html>