name: "Rebuild documentation"

on: push

jobs:
  deploy:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
        with:
          path: 'idmtools'
      - name: Checkout Documentation
        uses: actions/checkout@v2
        with:
          repository: git@github.com:InstituteforDiseaseModeling/Documentation.git
          path: 'Documentation'
      - name: Install dependencies
          run: |
            python -m pip install --upgrade pip
            pip install sphinx-rtd-theme sphinxcontrib-napoleon beautifulsoup4
      - name: Install dependencies
        uses: ammaraskar/sphinx-action@master
          with:
            docs-folder: "Documentation/"
            pre-build-command: "apt-get update -y && apt-get install -y latexmk texlive-latex-recommended texlive-latex-extra texlive-fonts-recommended plantuml"
            build-command: "make latexpdf"
      - name: Upload Documentation Artifacts
        uses: actions/upload-artifact@v1
          with:
            name: DocumentationHTML
            path: Documentation/idm-tools/_build/html/